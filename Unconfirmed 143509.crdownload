{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "1473486c",
   "metadata": {},
   "source": [
    "## Small Image Classification Using Simple Aritifical Neural Network: GPU Benchmarking"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "f8a6ff68",
   "metadata": {},
   "outputs": [],
   "source": [
    "import tensorflow as tf\n",
    "from tensorflow import keras\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "# Version Information\n",
    "# tensorflow 2.2.0 , Cudnn7.6.5 and Cuda 10.1 , python 3.8"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bfb8bb31",
   "metadata": {},
   "source": [
    "##This command shows list of physical devices available for tensorflow. You can see GPU listed here. If you have NVIDIA GPU you need to install CUDA toolkit and cuDNN as per instruction on this webpage. Without proper installation you will not see GPU in list of devices"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "06c3c876",
   "metadata": {},
   "outputs": [],
   "source": [
    "tf.config.experimental.list_physical_devices()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "0ee4591c",
   "metadata": {
    "collapsed": true,
    "jupyter": {
     "outputs_hidden": true
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Default GPU Device: /device:GPU:0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2024-08-14 06:05:20.602283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /device:GPU:0 with 15288 MB memory:  -> device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 6.0\n",
      "2024-08-14 06:05:20.603142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /device:GPU:1 with 15288 MB memory:  -> device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:84:00.0, compute capability: 6.0\n",
      "2024-08-14 06:05:20.607269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /device:GPU:0 with 15288 MB memory:  -> device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 6.0\n",
      "2024-08-14 06:05:20.607527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /device:GPU:1 with 15288 MB memory:  -> device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:84:00.0, compute capability: 6.0\n"
     ]
    }
   ],
   "source": [
    "import tensorflow as tf\n",
    "if tf.test.gpu_device_name():\n",
    "    print('Default GPU Device: {}'.format(tf.test.gpu_device_name()))\n",
    "else:\n",
    "    print(\"Please install GPU version of TF\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "6c56618e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "True\n"
     ]
    }
   ],
   "source": [
    "import tensorflow as tf\n",
    "print(tf.test.is_built_with_cuda())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "53918b0e",
   "metadata": {
    "collapsed": true,
    "jupyter": {
     "outputs_hidden": true
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "WARNING:tensorflow:From /tmp/ipykernel_629/2964415598.py:1: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.\n",
      "Instructions for updating:\n",
      "Use `tf.config.list_physical_devices('GPU')` instead.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2024-08-14 06:06:15.752217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /device:GPU:0 with 15288 MB memory:  -> device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 6.0\n",
      "2024-08-14 06:06:15.752510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /device:GPU:1 with 15288 MB memory:  -> device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:84:00.0, compute capability: 6.0\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tf.test.is_gpu_available( cuda_only=False, min_cuda_compute_capability=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "48dcdbbe",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Num GPUs Available:  2\n"
     ]
    }
   ],
   "source": [
    " import tensorflow as tf\n",
    ">>> print(\"Num GPUs Available: \", len(tf.config.experimental.list_physical_devices('GPU')))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "1ef6cb0e",
   "metadata": {
    "collapsed": true,
    "jupyter": {
     "outputs_hidden": true
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2024-08-14 06:07:01.417722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /device:GPU:0 with 15288 MB memory:  -> device: 0, name: Tesla P100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 6.0\n",
      "2024-08-14 06:07:01.418139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /device:GPU:1 with 15288 MB memory:  -> device: 1, name: Tesla P100-SXM2-16GB, pci bus id: 0000:84:00.0, compute capability: 6.0\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "'/device:GPU:0'"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import tensorflow as tf\n",
    "tf.test.gpu_device_name()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "1e630c4f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Num GPUs Available:  2\n"
     ]
    }
   ],
   "source": [
    "print(\"Num GPUs Available: \", len(tf.config.list_physical_devices('GPU')))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "0bd0441d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'2.16.1'"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tf.__version__"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "05df86d2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tf.test.is_built_with_cuda()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5107ccb5",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "9ccac6be",
   "metadata": {},
   "source": [
    "## this Below the Commands are Check Cuda is Avialbe are not , in pytorch "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9499a9b9",
   "metadata": {},
   "outputs": [],
   "source": [
    "# import torch\n",
    "\n",
    "# # Check if CUDA is available\n",
    "# if torch.cuda.is_available():\n",
    "#     print(\"CUDA is available! Running on GPU.\")\n",
    "#     # Add your GPU-specific commands here\n",
    "#     # Example: Set the device\n",
    "#     device = torch.device(\"cuda\")\n",
    "#     print(\"Using device:\", device)\n",
    "\n",
    "#     # Example command using GPU\n",
    "#     tensor = torch.randn(3, 3).to(device)\n",
    "#     print(\"Tensor on GPU:\", tensor)\n",
    "\n",
    "# else:\n",
    "#     print(\"CUDA is not available. Running on CPU.\")\n",
    "#     # Add your CPU-specific commands here\n",
    "#     # Example: Set the device\n",
    "#     device = torch.device(\"cpu\")\n",
    "#     print(\"Using device:\", device)\n",
    "\n",
    "#     # Example command using CPU\n",
    "#     tensor = torch.randn(3, 3).to(device)\n",
    "#     print(\"Tensor on CPU:\", tensor)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1dcb0c08",
   "metadata": {},
   "source": [
    "## Load the dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9857646f",
   "metadata": {},
   "outputs": [],
   "source": [
    "## https://keras.io/api/datasets/   .  This Artical to follow to Downlaods a Dataset through a Keras "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "b57cbeb6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Downloading data from https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz\n",
      "170498071/170498071 [==============================] - 2708s 16us/step\n"
     ]
    }
   ],
   "source": [
    "(x_train, y_train), (x_test, y_test) = keras.datasets.cifar10.load_data()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "1a5ff0b8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "x_train.shape (50000, 32, 32, 3)\n",
      "y_train.shape (50000, 1)\n"
     ]
    }
   ],
   "source": [
    "print(\"x_train.shape\", x_train.shape)\n",
    "\n",
    "\n",
    "print(\"y_train.shape\" , y_train.shape)\n",
    "\n",
    "      "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "92f585b4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "y_train.shape (50000, 1)\n",
      "y_train.shape (10000, 1)\n"
     ]
    }
   ],
   "source": [
    "print(\"y_train.shape\", y_train.shape)\n",
    "\n",
    "\n",
    "print(\"y_train.shape\" , y_test.shape)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f423f23b",
   "metadata": {},
   "outputs": [],
   "source": [
    "# x_train.shape == (50000, 32, 32, 3)\n",
    "# x_test.shape == (10000, 32, 32, 3)\n",
    "# y_train.shape == (50000, 1)\n",
    "# y_test.shape == (10000, 1)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "557af387",
   "metadata": {},
   "source": [
    "## Data Visualization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "4de44b92",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "None\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1000x500 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "def plot_sample(index):\n",
    "    plt.figure(figsize = (10,5))\n",
    "    plt.imshow(x_train[index])\n",
    "print(plot_sample(0))    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "f36d012a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "None\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1000x500 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "print(plot_sample(2))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "797dee4f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['airplane', 'automobile', 'bird', 'cat', 'deer', 'dog', 'frog', 'horse', 'ship', 'truck']\n"
     ]
    }
   ],
   "source": [
    "classes = [\"airplane\",\"automobile\",\"bird\",\"cat\",\"deer\",\"dog\",\"frog\",\"horse\",\"ship\",\"truck\"]\n",
    "print(classes)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "b1cb31f5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'deer'"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "classes[y_train[3][0]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "d7c0fba3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[6],\n",
       "       [9],\n",
       "       [9]], dtype=uint8)"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_train[:3]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bbbad0ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Loads the CIFAR10 dataset.\n",
    "\n",
    "# This is a dataset of 50,000 32x32 color training images and 10,000 test images, labeled over 10 categories. See more info at the CIFAR homepage.\n",
    "\n",
    "# The classes are:\n",
    "\n",
    "# Label\tDescription\n",
    "# 0\tairplane\n",
    "# 1\tautomobile\n",
    "# 2\tbird\n",
    "# 3\tcat\n",
    "# 4\tdeer\n",
    "# 5\tdog\n",
    "# 6\tfrog\n",
    "# 7\thorse\n",
    "# 8\tship\n",
    "# 9\ttruck"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "5d1003be",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(10000, 1)"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_test.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "638dd98c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(50000, 32, 32, 3)"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x_train.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "df0e34a5",
   "metadata": {},
   "source": [
    "## Preprocessing: Scale images"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "2ddb5dbe",
   "metadata": {},
   "outputs": [],
   "source": [
    "x_train_scaled = x_train / 255\n",
    "x_test_scaled = x_test / 255"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "895afd92",
   "metadata": {},
   "outputs": [],
   "source": [
    "y_train_categorical = keras.utils.to_categorical(\n",
    "    y_train, num_classes=10, dtype='float32'\n",
    ")\n",
    "y_test_categorical = keras.utils.to_categorical(\n",
    "    y_test, num_classes=10, dtype='float32'\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "437d13a8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[6],\n",
       "       [9],\n",
       "       [9],\n",
       "       [4],\n",
       "       [1]], dtype=uint8)"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_train[0:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "765970e4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],\n",
       "       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.],\n",
       "       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.],\n",
       "       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],\n",
       "       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32)"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_train_categorical[0:5]\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "98f48594",
   "metadata": {},
   "source": [
    "## Model building and training ANN Model "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "226b6951",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n",
      "I0000 00:00:1723619588.184891    1137 service.cc:145] XLA service 0x7fcfa0c19f80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:\n",
      "I0000 00:00:1723619588.184934    1137 service.cc:153]   StreamExecutor device (0): Tesla P100-SXM2-16GB, Compute Capability 6.0\n",
      "I0000 00:00:1723619588.184937    1137 service.cc:153]   StreamExecutor device (1): Tesla P100-SXM2-16GB, Compute Capability 6.0\n",
      "2024-08-14 07:13:08.204679: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 90201\n",
      "I0000 00:00:1723619588.268774    1137 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1563/1563 [==============================] - 25s 4ms/step - loss: 1.8132 - accuracy: 0.3530\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<tf_keras.src.callbacks.History at 0x7fd26b165a80>"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model = keras.Sequential([\n",
    "        keras.layers.Flatten(input_shape=(32,32,3)),\n",
    "        keras.layers.Dense(3000, activation='relu'),\n",
    "        keras.layers.Dense(1000, activation='relu'),\n",
    "        keras.layers.Dense(10, activation='sigmoid')    \n",
    "    ])\n",
    "\n",
    "model.compile(optimizer='SGD',\n",
    "              loss='categorical_crossentropy',\n",
    "              metrics=['accuracy'])\n",
    "\n",
    "model.fit(x_train_scaled, y_train_categorical, epochs=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3f36bd97",
   "metadata": {},
   "source": [
    "## Let's make some predictions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "dfdadd49",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "313/313 [==============================] - 1s 2ms/step\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "6"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.argmax(model.predict(x_test_scaled)[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "bb232bc6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([3], dtype=uint8)"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_test[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "1cf15704",
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_model():\n",
    "    model = keras.Sequential([\n",
    "            keras.layers.Flatten(input_shape=(32,32,3)),\n",
    "            keras.layers.Dense(3000, activation='relu'),\n",
    "            keras.layers.Dense(1000, activation='relu'),\n",
    "            keras.layers.Dense(10, activation='sigmoid')    \n",
    "        ])\n",
    "\n",
    "    model.compile(optimizer='SGD',\n",
    "                  loss='categorical_crossentropy',\n",
    "                  metrics=['accuracy'])\n",
    "    return model\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5c117897",
   "metadata": {},
   "source": [
    "## Measure training time on a CPU"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "4358dd1c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   3/1563 [..............................] - ETA: 1:09 - loss: 2.3669 - accuracy: 0.1146 "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "I0000 00:00:1723619682.110282    1137 service.cc:145] XLA service 0x7fcfa1d7fad0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\n",
      "I0000 00:00:1723619682.110313    1137 service.cc:153]   StreamExecutor device (0): Host, Default Version\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1563/1563 [==============================] - 77s 49ms/step - loss: 1.8126 - accuracy: 0.3545\n",
      "1min 18s ± 0 ns per loop (mean ± std. dev. of 1 run, 1 loop each)\n"
     ]
    }
   ],
   "source": [
    "%%timeit -n1 -r1 \n",
    "with tf.device('/CPU:0'):\n",
    "    cpu_model = get_model()\n",
    "    cpu_model.fit(x_train_scaled, y_train_categorical, epochs=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "227330d0",
   "metadata": {},
   "source": [
    "## Lets measure training time on a GPU (I've NVIDIA Tesla P100-SXM2-16GB with Two GPUs)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "f5056dca",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Wed Aug 14 07:16:48 2024       \n",
      "+-----------------------------------------------------------------------------------------+\n",
      "| NVIDIA-SMI 560.28.03              Driver Version: 560.28.03      CUDA Version: 12.6     |\n",
      "|-----------------------------------------+------------------------+----------------------+\n",
      "| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |\n",
      "| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |\n",
      "|                                         |                        |               MIG M. |\n",
      "|=========================================+========================+======================|\n",
      "|   0  Tesla P100-SXM2-16GB           Off |   00000000:06:00.0 Off |                  Off |\n",
      "| N/A   39C    P0             42W /  300W |   15570MiB /  16384MiB |      0%      Default |\n",
      "|                                         |                        |                  N/A |\n",
      "+-----------------------------------------+------------------------+----------------------+\n",
      "|   1  Tesla P100-SXM2-16GB           Off |   00000000:84:00.0 Off |                  Off |\n",
      "| N/A   38C    P0             44W /  300W |     266MiB /  16384MiB |      0%      Default |\n",
      "|                                         |                        |                  N/A |\n",
      "+-----------------------------------------+------------------------+----------------------+\n",
      "                                                                                         \n",
      "+-----------------------------------------------------------------------------------------+\n",
      "| Processes:                                                                              |\n",
      "|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |\n",
      "|        ID   ID                                                               Usage      |\n",
      "|=========================================================================================|\n",
      "+-----------------------------------------------------------------------------------------+\n"
     ]
    }
   ],
   "source": [
    "# !nvidia-smi "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "68cc56bb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1563/1563 [==============================] - 7s 4ms/step - loss: 1.8135 - accuracy: 0.3535\n",
      "9.97 s ± 0 ns per loop (mean ± std. dev. of 1 run, 1 loop each)\n"
     ]
    }
   ],
   "source": [
    "%%timeit -n1 -r1 \n",
    "with tf.device('/GPU:0'):\n",
    "    cpu_model = get_model()\n",
    "    cpu_model.fit(x_train_scaled, y_train_categorical, epochs=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2ede0cc9",
   "metadata": {},
   "source": [
    "## Lets run same test for 10 epocs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "72411852",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/10\n",
      "1563/1563 [==============================] - 75s 47ms/step - loss: 1.8119 - accuracy: 0.3587\n",
      "Epoch 2/10\n",
      "1563/1563 [==============================] - 74s 47ms/step - loss: 1.6253 - accuracy: 0.4280\n",
      "Epoch 3/10\n",
      "1563/1563 [==============================] - 72s 46ms/step - loss: 1.5407 - accuracy: 0.4570\n",
      "Epoch 4/10\n",
      "1563/1563 [==============================] - 72s 46ms/step - loss: 1.4814 - accuracy: 0.4781\n",
      "Epoch 5/10\n",
      "1563/1563 [==============================] - 72s 46ms/step - loss: 1.4330 - accuracy: 0.4957\n",
      "Epoch 6/10\n",
      "1563/1563 [==============================] - 71s 46ms/step - loss: 1.3876 - accuracy: 0.5106\n",
      "Epoch 7/10\n",
      "1563/1563 [==============================] - 71s 45ms/step - loss: 1.3517 - accuracy: 0.5253\n",
      "Epoch 8/10\n",
      "1563/1563 [==============================] - 71s 46ms/step - loss: 1.3158 - accuracy: 0.5397\n",
      "Epoch 9/10\n",
      "1563/1563 [==============================] - 71s 46ms/step - loss: 1.2828 - accuracy: 0.5499\n",
      "Epoch 10/10\n",
      "1563/1563 [==============================] - 75s 48ms/step - loss: 1.2526 - accuracy: 0.5605\n",
      "12min 6s ± 0 ns per loop (mean ± std. dev. of 1 run, 1 loop each)\n"
     ]
    }
   ],
   "source": [
    "%%timeit -n1 -r1 \n",
    "with tf.device('/CPU:0'):\n",
    "    cpu_model = get_model()\n",
    "    cpu_model.fit(x_train_scaled, y_train_categorical, epochs=10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "d0c6adb4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/10\n",
      "1563/1563 [==============================] - 8s 4ms/step - loss: 1.8132 - accuracy: 0.3540\n",
      "Epoch 2/10\n",
      "1563/1563 [==============================] - 6s 4ms/step - loss: 1.6228 - accuracy: 0.4275\n",
      "Epoch 3/10\n",
      "1563/1563 [==============================] - 6s 4ms/step - loss: 1.5420 - accuracy: 0.4570\n",
      "Epoch 4/10\n",
      "1563/1563 [==============================] - 6s 4ms/step - loss: 1.4827 - accuracy: 0.4790\n",
      "Epoch 5/10\n",
      "1563/1563 [==============================] - 6s 4ms/step - loss: 1.4327 - accuracy: 0.4961\n",
      "Epoch 6/10\n",
      "1563/1563 [==============================] - 6s 4ms/step - loss: 1.3891 - accuracy: 0.5135\n",
      "Epoch 7/10\n",
      "1563/1563 [==============================] - 6s 4ms/step - loss: 1.3511 - accuracy: 0.5259\n",
      "Epoch 8/10\n",
      "1563/1563 [==============================] - 6s 4ms/step - loss: 1.3174 - accuracy: 0.5384\n",
      "Epoch 9/10\n",
      "1563/1563 [==============================] - 6s 4ms/step - loss: 1.2849 - accuracy: 0.5517\n",
      "Epoch 10/10\n",
      "1563/1563 [==============================] - 6s 4ms/step - loss: 1.2546 - accuracy: 0.5621\n",
      "1min 7s ± 0 ns per loop (mean ± std. dev. of 1 run, 1 loop each)\n"
     ]
    }
   ],
   "source": [
    "%%timeit -n1 -r1 \n",
    "with tf.device('/GPU:0'):\n",
    "    cpu_model = get_model()\n",
    "    cpu_model.fit(x_train_scaled, y_train_categorical, epochs=10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "766d4a04",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "67e5d7ea",
   "metadata": {},
   "source": [
    "# Here is the performance comparison for 1 epoch,\n",
    "\n",
    "#       Epoch       CPU              GPU\n",
    "# 1     Epoch  1 min[CPU]        [GPU] 9.97 Sec\n",
    "# 10    Epoch   12 min[CPU]       [GPU] 1 min "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5ea515f1",
   "metadata": {},
   "source": [
    "## Model Convolutional Neural Network (CNN)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "086e27d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "import tensorflow as tf\n",
    "from tensorflow import keras\n",
    "\n",
    "def get_cnn_model():\n",
    "    model = keras.Sequential([\n",
    "        # Convolutional layers with pooling\n",
    "        keras.layers.Conv2D(32, kernel_size=(3, 3), activation='relu', input_shape=(32, 32, 3)),\n",
    "        keras.layers.MaxPooling2D(pool_size=(2, 2)),\n",
    "        \n",
    "        keras.layers.Conv2D(64, kernel_size=(3, 3), activation='relu'),\n",
    "        keras.layers.MaxPooling2D(pool_size=(2, 2)),\n",
    "        \n",
    "        keras.layers.Conv2D(128, kernel_size=(3, 3), activation='relu'),\n",
    "        keras.layers.MaxPooling2D(pool_size=(2, 2)),\n",
    "        \n",
    "        # Flatten the output for the Dense layers\n",
    "        keras.layers.Flatten(),\n",
    "        \n",
    "        # Fully connected layers\n",
    "        keras.layers.Dense(3000, activation='relu'),\n",
    "        keras.layers.Dense(1000, activation='relu'),\n",
    "        \n",
    "        # Output layer\n",
    "        keras.layers.Dense(10, activation='softmax')    \n",
    "    ])\n",
    "\n",
    "    # Compile the model\n",
    "    model.compile(optimizer='SGD',\n",
    "                  loss='categorical_crossentropy',\n",
    "                  metrics=['accuracy'])\n",
    "    return model\n",
    "\n",
    "# To create the model\n",
    "model = get_cnn_model()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "9d960fb3",
   "metadata": {},
   "outputs": [],
   "source": [
    "import time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "5697c40d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1563/1563 [==============================] - 61s 37ms/step - loss: 2.1030 - accuracy: 0.2266\n",
      "Training time on CPU: 62.54 seconds\n"
     ]
    }
   ],
   "source": [
    "# # Measure training time on CPU\n",
    "# %%timeit -n1 -r1\n",
    "# with tf.device('/CPU:0'):\n",
    "#     cpu_model = get_cnn_model()\n",
    "#     cpu_model.fit(X_train_scaled, y_train_categorical, epochs=1)\n",
    "\n",
    "\n",
    "start_time = time.time()\n",
    "with tf.device('/CPU:0'):\n",
    "    cpu_model = get_cnn_model()\n",
    "    cpu_model.fit(x_train_scaled, y_train_categorical, epochs=1)\n",
    "cpu_time = time.time() - start_time\n",
    "print(f\"Training time on CPU: {cpu_time:.2f} seconds\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "c2e4a554",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1563/1563 [==============================] - 14s 7ms/step - loss: 2.1293 - accuracy: 0.2064\n",
      "Training time on GPU: 16.11 seconds\n"
     ]
    }
   ],
   "source": [
    "# #Measure Training Time on GPU:\n",
    "\n",
    "# # Measure training time on GPU\n",
    "# %%timeit -n1 -r1\n",
    "# with tf.device('/GPU:0'):\n",
    "#     gpu_model = get_cnn_model()\n",
    "#     gpu_model.fit(X_train_scaled, y_train_categorical, epochs=1)\n",
    "\n",
    "\n",
    "\n",
    "start_time = time.time()\n",
    "with tf.device('/GPU:0'):\n",
    "    gpu_model = get_cnn_model()\n",
    "    gpu_model.fit(x_train_scaled, y_train_categorical, epochs=1)\n",
    "gpu_time = time.time() - start_time\n",
    "print(f\"Training time on GPU: {gpu_time:.2f} seconds\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "84408160",
   "metadata": {},
   "outputs": [],
   "source": [
    "## Measure Training Time for Multiple Epochs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "082347dd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/10\n",
      "1563/1563 [==============================] - 61s 37ms/step - loss: 2.1337 - accuracy: 0.2088\n",
      "Epoch 2/10\n",
      "1563/1563 [==============================] - 61s 39ms/step - loss: 1.7630 - accuracy: 0.3605\n",
      "Epoch 3/10\n",
      "1563/1563 [==============================] - 63s 40ms/step - loss: 1.5372 - accuracy: 0.4428\n",
      "Epoch 4/10\n",
      "1563/1563 [==============================] - 59s 38ms/step - loss: 1.3975 - accuracy: 0.4997\n",
      "Epoch 5/10\n",
      "1563/1563 [==============================] - 66s 42ms/step - loss: 1.2905 - accuracy: 0.5405\n",
      "Epoch 6/10\n",
      "1563/1563 [==============================] - 67s 43ms/step - loss: 1.2081 - accuracy: 0.5718\n",
      "Epoch 7/10\n",
      "1563/1563 [==============================] - 64s 41ms/step - loss: 1.1337 - accuracy: 0.6021\n",
      "Epoch 8/10\n",
      "1563/1563 [==============================] - 61s 39ms/step - loss: 1.0677 - accuracy: 0.6263\n",
      "Epoch 9/10\n",
      "1563/1563 [==============================] - 61s 39ms/step - loss: 1.0079 - accuracy: 0.6499\n",
      "Epoch 10/10\n",
      "1563/1563 [==============================] - 61s 39ms/step - loss: 0.9506 - accuracy: 0.6696\n",
      "Training time on CPU: 625.68 seconds\n"
     ]
    }
   ],
   "source": [
    "## On CPU:\n",
    "\n",
    "# # Measure training time on CPU for 10 epochs\n",
    "# %%timeit -n1 -r1\n",
    "# with tf.device('/CPU:0'):\n",
    "#     cpu_model = get_cnn_model()\n",
    "#     cpu_model.fit(X_train_scaled, y_train_categorical, epochs=10)\n",
    "\n",
    "start_time = time.time()\n",
    "with tf.device('/CPU:0'):\n",
    "    cpu_model = get_cnn_model()\n",
    "    cpu_model.fit(x_train_scaled, y_train_categorical, epochs=10)\n",
    "cpu_time = time.time() - start_time\n",
    "print(f\"Training time on CPU: {cpu_time:.2f} seconds\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "759d1491",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/10\n",
      "1563/1563 [==============================] - 12s 6ms/step - loss: 2.1174 - accuracy: 0.2111\n",
      "Epoch 2/10\n",
      "1563/1563 [==============================] - 10s 6ms/step - loss: 1.7631 - accuracy: 0.3598\n",
      "Epoch 3/10\n",
      "1563/1563 [==============================] - 10s 6ms/step - loss: 1.5390 - accuracy: 0.4444\n",
      "Epoch 4/10\n",
      "1563/1563 [==============================] - 10s 6ms/step - loss: 1.4006 - accuracy: 0.4989\n",
      "Epoch 5/10\n",
      "1563/1563 [==============================] - 10s 6ms/step - loss: 1.2879 - accuracy: 0.5407\n",
      "Epoch 6/10\n",
      "1563/1563 [==============================] - 10s 6ms/step - loss: 1.2004 - accuracy: 0.5760\n",
      "Epoch 7/10\n",
      "1563/1563 [==============================] - 10s 7ms/step - loss: 1.1267 - accuracy: 0.6040\n",
      "Epoch 8/10\n",
      "1563/1563 [==============================] - 10s 7ms/step - loss: 1.0581 - accuracy: 0.6289\n",
      "Epoch 9/10\n",
      "1563/1563 [==============================] - 10s 7ms/step - loss: 0.9979 - accuracy: 0.6519\n",
      "Epoch 10/10\n",
      "1563/1563 [==============================] - 10s 7ms/step - loss: 0.9391 - accuracy: 0.6740\n",
      "Training time on GPU: 105.17 seconds\n"
     ]
    }
   ],
   "source": [
    "# ## On GPU:\n",
    "\n",
    "# # Measure training time on GPU for 10 epochs\n",
    "# %%timeit -n1 -r1\n",
    "# with tf.device('/GPU:0'):\n",
    "#     gpu_model = get_cnn_model()\n",
    "#     gpu_model.fit(X_train_scaled, y_train_categorical, epochs=10)\n",
    "\n",
    "\n",
    "\n",
    "start_time = time.time()\n",
    "with tf.device('/GPU:0'):\n",
    "    gpu_model = get_cnn_model()\n",
    "    gpu_model.fit(x_train_scaled, y_train_categorical, epochs=10)\n",
    "gpu_time = time.time() - start_time\n",
    "print(f\"Training time on GPU: {gpu_time:.2f} seconds\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f8991c9d",
   "metadata": {},
   "source": [
    "# Here is the performance comparison for 1 epoch,\n",
    "\n",
    "#       Epoch       CPU              GPU\n",
    "# 1     Epoch  62.54 [CPU]        [GPU] 16. 11 Sec\n",
    "# 10    Epoch   625.68 [CPU]       [GPU] 105.17 Sec"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3f4fe639",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
